---
description: "Quick reference patterns"
globs:
  - **/*.cs
alwaysApply: false
---

## Quick Reference: Common Patterns

### Adding a New API Endpoint

1. **Create Function** (`Functions/NewFeatureAPI.cs`):
```csharp
[MRIAuthentication]
[Function("NewFeature")]
public async Task<BaseResponseDTO> Run(
    [HttpTrigger(AuthorizationLevel.Anonymous, "post")] HttpRequest req, 
    FunctionContext context)
{
    _logger.Info("HTTP received for NewFeatureAPI.");
    
    var request = await req.ReadBodyAsync<NewFeatureRequestDTO>();
    if (request == null)
    {
        throw new RequestValidationFailureException() 
        { 
            ErrorProperties = [ErrorConstants.INVALID_REQ_PAYLOAD] 
        };
    }
    
    request.ValidateAPIRequestParameters();
    
    if (context.Items.TryGetValue(InfoConstants.SESSION_ID, out var sessionIdObj) && 
        sessionIdObj is string sessionId)
    {
        request.SessionId = sessionId;
    }
    else
    {
        throw new BaseException(ErrorConstants.SESSION_ID_NOT_FOUND_IN_CONTEXT);
    }
    
    var result = await _handler.ProcessRequest(request);
    return result;
}
```

2. **Create Handler** (`Implementations/MRI/Handlers/NewFeatureMRIHandler.cs`)
3. **Create Atomic Handler** (`Implementations/MRI/AtomicHandlers/NewFeatureAtomicHandler/`)
4. **Create DTOs** (`DTO/NewFeatureDTO/`)
5. **Register in Program.cs**
6. **Add SOAP envelope** (if needed)
7. **Add configuration** (if needed)

---

